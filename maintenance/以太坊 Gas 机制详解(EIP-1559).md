# ä»¥å¤ªåŠ Gas æœºåˆ¶è¯¦è§£(EIP-1559)

ä»¥å¤ªåŠç½‘ç»œçš„Gasæœºåˆ¶æ˜¯åŒºå—é“¾æŠ€æœ¯ä¸­ç‹¬ç‰¹çš„èµ„æºç®¡ç†æ–¹æ¡ˆã€‚é€šè¿‡å°†ç½‘ç»œèµ„æºæ¶ˆè€—é‡åŒ–ä¸ºGaså•ä½ï¼Œæ—¢ä¿éšœäº†ç½‘ç»œç¨³å®šæ€§ï¼Œåˆæž„å»ºäº†åŽ»ä¸­å¿ƒåŒ–çš„äº¤æ˜“å®šä»·ä½“ç³»ã€‚EIP-1559ææ¡ˆçš„å®žæ–½æ ‡å¿—ç€ä»¥å¤ªåŠä»Žç«žä»·æ‹å–æ¨¡å¼å‘åŠ¨æ€å®šä»·æœºåˆ¶çš„è¿›åŒ–ï¼Œä¸ºç”¨æˆ·æä¾›æ›´å¯é¢„æµ‹çš„äº¤æ˜“æˆæœ¬å’Œæ›´é«˜æ•ˆçš„ç½‘ç»œä½“éªŒã€‚

## GasåŸºç¡€æ¦‚å¿µè§£æž

Gasæ˜¯ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦æ‰§è¡Œçš„æ ¸å¿ƒè®¡é‡å•ä½ï¼Œå…¶æœ¬è´¨æ˜¯ç”¨æˆ·ä¸ºç½‘ç»œèµ„æºæ¶ˆè€—æ”¯ä»˜çš„æŠ¥é…¬ã€‚æ¯ç¬”äº¤æ˜“çš„è´¹ç”¨è®¡ç®—å…¬å¼ä¸ºï¼š

**äº¤æ˜“è´¹ç”¨ = Gasæ¶ˆè€—é‡ Ã— Gaså•ä»·**

ðŸ‘‰ [æ·±å…¥ç†è§£åŒºå—é“¾æŠ€æœ¯åŽŸç†](https://bit.ly/okx_welcome)

### æ ¸å¿ƒå‚æ•°è§£æžè¡¨

| å‚æ•°åç§°          | è‹±æ–‡å…¨ç§°                  | ä¸­æ–‡è§£é‡Š                     |
|-------------------|---------------------------|------------------------------|
| GasLimit          | Gas Limit                 | ç”¨æˆ·æ„¿ä¸ºå•ç¬”äº¤æ˜“æ”¯ä»˜çš„Gasä¸Šé™ |
| GasPrice          | Gas Price                 | ç”¨æˆ·æ”¯ä»˜çš„å•ä½Gasä»·æ ¼         |
| GasUsed           | Gas Used                  | å®žé™…æ¶ˆè€—çš„Gasæ•°é‡             |

ä¼ ç»Ÿäº¤æ˜“æ¨¡å¼ä¸‹ï¼Œç”¨æˆ·éœ€è¦æ‰‹åŠ¨è®¾ç½®GasPriceä¸ŽGasLimitã€‚å½“GasUsedâ‰¤GasLimitæ—¶ï¼Œæœªæ¶ˆè€—çš„Gaså°†é€€è¿˜ç»™ç”¨æˆ·ã€‚è¿™ç§è®¾è®¡æ—¢é˜²æ­¢äº†èµ„æºæµªè´¹ï¼Œåˆä¿éšœäº†äº¤æ˜“æ‰§è¡Œçš„ç¡®å®šæ€§ã€‚

## EIP-1559çš„æ ¸å¿ƒåˆ›æ–°

### BaseFeeæœºåˆ¶è§£æž

ä½œä¸ºEIP-1559çš„æ ¸å¿ƒåˆ›æ–°ï¼ŒBaseFeeï¼ˆåŸºç¡€è´¹ç”¨ï¼‰å®žçŽ°äº†ç½‘ç»œæ‹¥å µç¨‹åº¦çš„åŠ¨æ€å“åº”ã€‚å…¶è®¡ç®—å…¬å¼ä¸ºï¼š

$$
\text{BaseFee}_{new} = 
\begin{cases} 
\text{BaseFee}_{old} \times \left(1 + \frac{\Delta \text{GasUsed}}{\text{GasTarget} \times 8}\right) & \text{å½“GasUsed > GasTarget} \\
\text{BaseFee}_{old} \times \left(1 - \frac{\Delta \text{GasUsed}}{\text{GasTarget} \times 8}\right) & \text{å½“GasUsed < GasTarget}
\end{cases}
$$

**BaseFeeè®¡ç®—ç¤ºä¾‹ï¼ˆå•ä½ï¼šGweiï¼‰**

| åŒºå—é«˜åº¦   | GasUsed | GasTarget | BaseFeeå˜åŒ–çŽ‡ | æ–°BaseFee |
|------------|---------|-----------|---------------|-----------|
| 18247918   | 11,234,567 | 15,000,000 | -24%          | 6.79      |
| 18247919   | 13,500,000 | 15,000,000 | -10%          | 6.59      |

ðŸ‘‰ [æŽ¢ç´¢åŒºå—é“¾å‰æ²¿æŠ€æœ¯](https://bit.ly/okx_welcome)

### åŠ¨æ€è°ƒæ•´æœºåˆ¶ä¼˜åŠ¿

1. **ç½‘ç»œè´Ÿè½½å‡è¡¡**ï¼šé€šè¿‡æ¯åŒºå—è°ƒæ•´BaseFeeï¼Œä½¿GasUsedå‘GasTargetæ”¶æ•›
2. **è´¹ç”¨é¢„æµ‹æ€§æå‡**ï¼šç”¨æˆ·å¯é€šè¿‡BaseFeeåŽ†å²æ•°æ®é¢„ä¼°äº¤æ˜“æˆæœ¬
3. **ç‡ƒçƒ§æœºåˆ¶å¼•å…¥**ï¼šBaseFeeéƒ¨åˆ†è¿›å…¥é»‘æ´žåœ°å€ï¼Œå®žçŽ°é€šç¼©æ•ˆåº”

## äº¤æ˜“è´¹ç”¨ç»“æž„ä¼˜åŒ–

### ä¼˜å…ˆè´¹ç”¨ï¼ˆMaxPriorityFeeï¼‰

ä½œä¸ºçŸ¿å·¥æ¿€åŠ±éƒ¨åˆ†ï¼ŒMaxPriorityFeeå…·æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š

- **åŠ¨æ€è°ƒæ•´**ï¼šé€šè¿‡eth_maxPriorityFeePerGasæŽ¥å£å®žæ—¶èŽ·å–
- **æ‰“åŒ…ä¼˜å…ˆçº§**ï¼šå€¼è¶Šå¤§äº¤æ˜“è¢«æ‰“åŒ…é€Ÿåº¦è¶Šå¿«
- **è´¹ç”¨å…¬å¼**ï¼šæœ€ç»ˆGasPrice = BaseFee + MaxPriorityFee

### æœ€å¤§è´¹ç”¨ï¼ˆMaxFeeï¼‰è®¾ç½®ç­–ç•¥

ä¸ºåº”å¯¹BaseFeeæ³¢åŠ¨ï¼Œå»ºè®®é‡‡ç”¨ä»¥ä¸‹å…¬å¼è®¾ç½®æœ€å¤§è´¹ç”¨ï¼š
$$
\text{MaxFee} = 2 \times \text{BaseFee} + \text{MaxPriorityFee}
$$

æ­¤ç­–ç•¥å¯ç¡®ä¿äº¤æ˜“åœ¨è¿žç»­6ä¸ªæ»¡GasåŒºå—ä¸­ä¿æŒæœ‰æ•ˆæ€§ï¼Œå¹³è¡¡äº¤æ˜“æˆåŠŸçŽ‡ä¸Žæˆæœ¬æŽ§åˆ¶ã€‚

## äº¤æ˜“è´¹ç”¨åˆ†è§£ç¤ºä¾‹

ä»¥æŸç¬”å®žé™…äº¤æ˜“ä¸ºä¾‹ï¼ˆGasUsed=115,855ï¼‰ï¼š

| è´¹ç”¨ç±»åž‹       | å•ä»·(Gwei) | æ•°é‡(Gwei) | è®¡ç®—å…¬å¼                     |
|----------------|------------|------------|------------------------------|
| åŸºç¡€è´¹ç”¨       | 7.407585749| 858,205.85 | BaseFeeÃ—GasUsed              |
| ä¼˜å…ˆè´¹ç”¨       | 0.05       | 5,792.75   | MaxPriorityFeeÃ—GasUsed       |
| æ€»äº¤æ˜“è´¹ç”¨     | 7.457585749| 863,998.60 | (BaseFee+MaxPriorityFee)Ã—GasUsed |
| ç†è®ºæœ€å¤§æ”¯å‡º   | 7.657591636| 887,170.28 | MaxFeeÃ—GasUsed               |
| å®žé™…èŠ‚çœè´¹ç”¨   | -          | 23,171.68  | MaxFeeÃ—GasUsed - å®žé™…æ”¯å‡º    |

ðŸ‘‰ [æŽŒæ¡åŠ å¯†èµ„äº§æŠ•èµ„ç­–ç•¥](https://bit.ly/okx_welcome)

## å¼€å‘è€…æŽ¥å£æŒ‡å—

### JSON-RPCå…³é”®æŽ¥å£

| æŽ¥å£åç§°                  | åŠŸèƒ½è¯´æ˜Ž                     | å…¸åž‹åº”ç”¨åœºæ™¯               |
|---------------------------|------------------------------|----------------------------|
| eth_estimateGas           | é¢„ä¼°äº¤æ˜“Gasæ¶ˆè€—é‡            | è®¾ç½®åˆç†GasLimit           |
| eth_maxPriorityFeePerGas  | èŽ·å–å½“å‰ä¼˜å…ˆè´¹ç”¨å»ºè®®å€¼       | ä¼˜åŒ–äº¤æ˜“æ‰“åŒ…é€Ÿåº¦           |
| eth_getBlockByNumber      | èŽ·å–åŒºå—è¯¦ç»†ä¿¡æ¯ï¼ˆå«BaseFeeï¼‰| æž„å»ºåŠ¨æ€Gaså®šä»·ç­–ç•¥        |

**å¼€å‘ç¤ºä¾‹ï¼šåŠ¨æ€Gasè®¾ç½®æµç¨‹**

```python
# 1. èŽ·å–æœ€æ–°åŒºå—ä¿¡æ¯
block_info = eth_getBlockByNumber("latest")
base_fee = block_info["baseFeePerGas"]

# 2. èŽ·å–ä¼˜å…ˆè´¹ç”¨å»ºè®®
priority_fee = eth_maxPriorityFeePerGas()

# 3. è®¡ç®—æœ€å¤§è´¹ç”¨
max_fee = 2 * base_fee + priority_fee

# 4. é¢„ä¼°Gasæ¶ˆè€—
gas_limit = eth_estimateGas(transaction_params)
```

## å¸¸è§é—®é¢˜è§£ç­”ï¼ˆFAQï¼‰

**Q1ï¼šä¸ºä»€ä¹ˆEIP-1559è¦å¼•å…¥BaseFeeç‡ƒçƒ§æœºåˆ¶ï¼Ÿ**  
Aï¼šç‡ƒçƒ§æœºåˆ¶é€šè¿‡é”€æ¯éƒ¨åˆ†æ‰‹ç»­è´¹å®žçŽ°ETHé€šç¼©ï¼Œå¹³è¡¡ç½‘ç»œå®‰å…¨æ€§ä¸Žä»£å¸ç»æµŽæ¨¡åž‹ã€‚æ•°æ®æ˜¾ç¤ºï¼Œ2021-2023å¹´é—´ç´¯è®¡é”€æ¯è¶…300ä¸‡ETHï¼Œæœ‰æ•ˆå‡ç¼“äº†é€šèƒ€åŽ‹åŠ›ã€‚

**Q2ï¼šå¦‚ä½•è®¾ç½®åˆç†çš„GasLimitï¼Ÿ**  
Aï¼šå»ºè®®é‡‡ç”¨"é¢„ä¼°+10%"åŽŸåˆ™ï¼šé€šè¿‡eth_estimateGasèŽ·å–é¢„ä¼°å€¼åŽï¼Œå¢žåŠ 10%-20%çš„å®‰å…¨ä½™é‡ï¼Œæ—¢é˜²æ­¢äº¤æ˜“å¤±è´¥ï¼Œåˆé¿å…Gasæµªè´¹ã€‚

**Q3ï¼šBaseFeeçš„è°ƒæ•´ç²¾åº¦å¦‚ä½•ä¿è¯ï¼Ÿ**  
Aï¼šä»¥å¤ªåŠé‡‡ç”¨å®šç‚¹æ•°è®¡ç®—ï¼ˆæ¯ä¸ªGwei=1e9 weiï¼‰ï¼Œé…åˆ8ä½œä¸ºè°ƒæ•´åˆ†æ¯ï¼Œæ—¢ä¿è¯è®¡ç®—æ•ˆçŽ‡ï¼Œåˆç»´æŒè¶³å¤Ÿçš„ä»·æ ¼åˆ†è¾¨çŽ‡ã€‚å®žæµ‹æ˜¾ç¤ºï¼Œæ‹¥å µæƒ…å†µä¸‹BaseFeeè°ƒæ•´è¯¯å·®çŽ‡<0.1%ã€‚

**Q4ï¼šMaxPriorityFeeçš„åˆç†å–å€¼èŒƒå›´æ˜¯å¤šå°‘ï¼Ÿ**  
Aï¼šæ ¹æ®etherscanå®žæ—¶æ•°æ®ï¼Œæ™®é€šäº¤æ˜“å»ºè®®è®¾ç½®0.01-0.1 Gweiï¼Œç´§æ€¥äº¤æ˜“å¯æå‡è‡³1-2 Gweiã€‚è¶…è¿‡2 Gweiçš„è®¾ç½®é€šå¸¸æ— å®žé™…æ”¶ç›Šã€‚

**Q5ï¼šEIP-1559å¯¹ç”¨æˆ·æœ‰ä½•å®žé™…å¥½å¤„ï¼Ÿ**  
Aï¼šæ˜¾è‘—é™ä½ŽGasä»·æ ¼æ³¢åŠ¨æ€§ã€‚ç»Ÿè®¡æ˜¾ç¤ºï¼Œå®žæ–½åŽGasPriceæ ‡å‡†å·®ä¸‹é™62%ï¼Œäº¤æ˜“å¤±è´¥çŽ‡ä»Ž12%é™è‡³3%ï¼Œç”¨æˆ·ä½“éªŒæ˜¾è‘—æå‡ã€‚

## æŠ€æœ¯æ¼”è¿›å±•æœ›

éšç€Layer2æ–¹æ¡ˆçš„æ™®åŠå’Œåˆ†ç‰‡æŠ€æœ¯çš„å‘å±•ï¼ŒGasæœºåˆ¶å°†æŒç»­è¿›åŒ–ã€‚æ½œåœ¨æ”¹è¿›æ–¹å‘åŒ…æ‹¬ï¼š

1. **åŠ¨æ€GasTargetæœºåˆ¶**ï¼šæ ¹æ®åŽ†å²è´Ÿè½½è‡ªåŠ¨è°ƒæ•´GasTarget
2. **è·¨å±‚å®šä»·æ¨¡åž‹**ï¼šå®žçŽ°L1ä¸ŽL2çš„Gasä»·æ ¼è”åŠ¨